import{d as z,r as d,_ as B,u as $,o as P,c as w,a as S,w as o,b as t,e as u,f as D,g,t as G,h as O,i as R,j as X,k as s}from"./index-CLhOq8NC.js";import{l as q}from"./authApi-N1p8UDbZ.js";const H=z("auth",()=>{const _=d(null),r=d(""),v=d(!1),n=d(parseInt(sessionStorage.getItem("loginAttempts")||"0")),a=5;return{user:_,loginError:r,isLoading:v,login:async b=>{if(n.value>=a)return r.value="로그인 시도 횟수를 초과했습니다. 잠시 후 다시 시도해주세요.",{success:!1};try{v.value=!0,r.value="";const m=await q.login(b);return _.value=m.data,n.value=0,sessionStorage.removeItem("loginAttempts"),{success:!0}}catch(m){if(n.value++,sessionStorage.setItem("loginAttempts",n.value.toString()),m.response)switch(m.response.status){case 401:r.value="아이디 또는 비밀번호가 일치하지 않습니다.";break;default:r.value="로그인 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요."}else r.value="서버와의 연결이 원활하지 않습니다.";return{success:!1}}finally{v.value=!1}},logout:()=>{_.value=null}}}),J={class:"d-flex justify-space-between mb-4"},K={__name:"AuthLoginView",setup(_){const r=X(),v=$(),n=H(),a=d({email:"",password:""}),p=d(!1),c=d({email:"",password:""});P(()=>{const l=localStorage.getItem("savedEmail");l&&(a.value.email=l,p.value=!0)});const b=()=>{let l=!0;return c.value={email:"",password:""},a.value.email.trim()||(c.value.email="이메일을 입력해주세요.",l=!1),a.value.password.trim()||(c.value.password="비밀번호를 입력해주세요.",l=!1),l},m=l=>{c.value[l]=""},V=async()=>{var e;if(!b())return;const{success:l}=await n.login({email:a.value.email,password:a.value.password});l?(p.value?localStorage.setItem("savedEmail",a.value.email):localStorage.removeItem("savedEmail"),v.changeMenuState(!0),v.setUserInfo({name:((e=n.user)==null?void 0:e.name)||"User"}),r.push("/")):a.value.password=""};return(l,e)=>{const k=s("v-card-title"),E=s("v-card-subtitle"),I=s("v-card-item"),y=s("v-text-field"),A=s("v-checkbox"),M=s("v-alert"),f=s("v-btn"),x=s("v-divider"),L=s("v-icon"),N=s("v-form"),U=s("v-card-text"),j=s("v-card"),C=s("v-col"),F=s("v-row"),T=s("v-container");return S(),w(T,{class:"fill-height",fluid:""},{default:o(()=>[t(F,{justify:"center",align:"center"},{default:o(()=>[t(C,{cols:"12",sm:"8",md:"6",lg:"4"},{default:o(()=>[t(j,{class:"login-card mx-auto","max-width":"400",elevation:"0",border:!0},{default:o(()=>[t(I,{class:"px-6 py-6"},{default:o(()=>[t(k,{class:"text-h5 font-weight-bold mb-2"},{default:o(()=>e[6]||(e[6]=[u(" 로그인 ")])),_:1}),t(E,{class:"text-body-2 text-grey-darken-1"},{default:o(()=>e[7]||(e[7]=[u(" 서비스를 이용하시려면 로그인해주세요. ")])),_:1})]),_:1}),t(U,{class:"px-6"},{default:o(()=>[t(N,{onSubmit:D(V,["prevent"])},{default:o(()=>[t(y,{modelValue:a.value.email,"onUpdate:modelValue":e[0]||(e[0]=i=>a.value.email=i),label:"이메일",type:"email",variant:"outlined",density:"comfortable",class:"mb-2","error-messages":c.value.email,onFocus:e[1]||(e[1]=i=>m("email"))},null,8,["modelValue","error-messages"]),t(y,{modelValue:a.value.password,"onUpdate:modelValue":e[2]||(e[2]=i=>a.value.password=i),label:"비밀번호",type:"password",variant:"outlined",density:"comfortable",class:"mb-2","error-messages":c.value.password,onFocus:e[3]||(e[3]=i=>m("password"))},null,8,["modelValue","error-messages"]),t(A,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=i=>p.value=i),label:"이메일 저장",class:"mb-2",density:"compact",color:"primary"},null,8,["modelValue"]),g(n).loginError?(S(),w(M,{key:0,type:"error",variant:"tonal",class:"mb-4",density:"compact"},{default:o(()=>[u(G(g(n).loginError),1)]),_:1})):O("",!0),t(f,{block:"",color:"primary",size:"large",type:"submit",loading:g(n).isLoading,class:"mb-4"},{default:o(()=>e[8]||(e[8]=[u(" 로그인 ")])),_:1},8,["loading"]),R("div",J,[t(f,{variant:"text",density:"comfortable",class:"text-caption",color:"grey-darken-1",onClick:e[5]||(e[5]=i=>g(r).push("/join"))},{default:o(()=>e[9]||(e[9]=[u(" 회원가입 ")])),_:1}),t(x,{vertical:"",class:"mx-2"}),t(f,{variant:"text",density:"comfortable",class:"text-caption",color:"grey-darken-1"},{default:o(()=>e[10]||(e[10]=[u(" 계정 찾기 ")])),_:1}),t(x,{vertical:"",class:"mx-2"}),t(f,{variant:"text",density:"comfortable",class:"text-caption",color:"grey-darken-1"},{default:o(()=>e[11]||(e[11]=[u(" 비밀번호 재설정 ")])),_:1})]),t(x,{class:"mb-4"}),t(f,{block:"",color:"#FEE500",size:"large",class:"text-black",elevation:"0"},{default:o(()=>[t(L,{icon:"mdi-chat",size:"18",class:"mr-2"}),e[12]||(e[12]=u(" 카카오 로그인 "))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},Y=B(K,[["__scopeId","data-v-28b83397"]]);export{Y as default};

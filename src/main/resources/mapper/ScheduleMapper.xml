<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- mapper file: 실행시킬 query를 가지고 있는 파일 -->
<mapper namespace="com.trip.schedule.mapper.ScheduleMapper">

    <!-- 생성된 key -> dto의 set 활용해서 id 대입-->
    <insert id="insertSchedule" useGeneratedKeys="true" keyProperty="schedule.scheduleId">
        INSERT INTO schedules (user_id, title, memo, total_cost, start_date, end_date)
        VALUES (#{userId}, #{schedule.title}, #{schedule.memo}, #{schedule.totalCost}, #{schedule.startDate}, #{schedule.endDate});
    </insert>

    <insert id="insertSchedulePlace">
        INSERT INTO schedule_places (schedule_id, attraction_id, visit_time, memo, cost, visit_order)
        VALUES (#{scheduleId}, #{place.attractionId}, #{place.visitTime}, #{place.memo}, #{place.cost}, #{place.visitOrder});
    </insert>

    <delete id="deleteSchedule">
        DELETE FROM schedules WHERE user_id = #{userId} AND schedule_id = #{scheduleId};
    </delete>

</mapper>

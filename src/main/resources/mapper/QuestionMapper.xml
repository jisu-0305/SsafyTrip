<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.trip.question.mapper.QuestionMapper">
    <!-- 결과 매핑 정의 -->
    <resultMap id="questionResultMap" type="QuestionsDto">
        <id property="questionId" column="question_id" />
        <result property="title" column="title" />
        <result property="createdAt" column="created_at" />
        <result property="isAnswered" column="is_answered" />
    </resultMap>

    <!-- 질문 목록 조회 -->
    <!-- 특정 user_id에 따른 질문 목록 조회 -->
    <select id="getQuestionsByUserId" resultMap="questionResultMap">
        SELECT question_id, title, created_at, is_answered
        FROM questions
        WHERE user_id = #{userId}
    </select>


    <insert id="insertQuestion" parameterType="QuestionInsertDto">
        INSERT INTO questions (user_id, title, content)
        VALUES (#{userId}, #{title}, #{content})
    </insert>


    <!-- ResultMap 정의  type="QuestionsDto-->
    <resultMap id="questionDetailtMap" type="QuestionDetailResDto">
        <id property="questionId" column="question_id"/>
        <result property="title" column="title"/>
        <result property="content" column="content"/>
        <result property="createdAt" column="created_at"/>
        <result property="isAnswered" column="is_answered"/>
    </resultMap>

    <!-- 특정 조건에 맞는 질문 데이터 조회 -->
    <select id="getQuestionByIdAndUserId" parameterType="map" resultMap="questionDetailtMap">
        SELECT question_id, title, content, created_at, is_answered
        FROM questions
        WHERE question_id = #{questionId} AND user_id = #{userId}
    </select>

</mapper>
